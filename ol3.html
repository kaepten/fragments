<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>

    <link rel="stylesheet" href="ol3/ol.css" type="text/css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">

    <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.2/js/bootstrap.min.js"></script>
    <script src="//api3.geo.admin.ch/loader.js?lang=en" type="text/javascript"></script>

</head>
<body>

<div id="mouse-position" >
    <div class="custom-mouse-position">&nbsp;   </div>
</div>
<div id="map" class="map"></div>


<script>

    // Create the background layer
    var layer = ga.layer.create('ch.swisstopo.pixelkarte-farbe');

    // Create a map
    var map = new ga.Map({
        target: document.getElementById('map'),
        layers: [layer],
        view: new ol.View2D({
            resolution: 0.5,
            center: [679432, 235682]
        })
    });

    var mousePositionControl = new ol.control.MousePosition({
        coordinateFormat: ol.coordinate.createStringXY(0),
        projection: 'EPSG:21781',
        className: 'custom-mouse-position',
        target: document.getElementById('mouse-position'),
        undefinedHTML: '&nbsp;'
    });

    map.addControl(mousePositionControl);

    // Create a local GeoJson
    var myGeoJson = {
        "type": "FeatureCollection",
        "features": [
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        679420,
                        235646
                    ]
                }
            }
        ]
    };

    // Define a geojson data source
    var source = new ol.source.GeoJSON();

    // Read the local geojson
    var features = source.readFeatures(myGeoJson);

    // Create a vector source and assign the GeoJson features to it
    var vectorSource = new ol.source.Vector({
        features: features
    });

    // Create a vector layer using the vector source
    var vectorLayer = new ol.layer.Vector({
        source: vectorSource
    });

    // Create a point icon style
    var iconStyle = new ol.style.Style({
        image: new ol.style.Icon(({
            src: '//map.geo.admin.ch/1403704943/img/marker.png',
            anchor: [0.53,1],
            size: [30,40]
        }))
    });

    // Apply the style to the vector layer
    vectorLayer.setStyle(iconStyle);

    // Add the vector layer in the map
    map.addLayer(vectorLayer);


    var featureOverlay = new ol.FeatureOverlay({
        map: map
        // ,style: new ol.style.Style({ stroke: {width: 2}})
    });


    var highlight;
    var displayFeatureInfo = function(pixel) {
        var features = [];
        map.forEachFeatureAtPixel(pixel, function(feature, layer) {
            features.push(feature);
        });

        // console.log (pixel);
        if (features[0] !== highlight) {
            if (highlight) {
                featureOverlay.removeFeature(highlight);
            }
            if (features[0]) {
                featureOverlay.addFeature(features[0]);
            }
            highlight = features[0];
        }


        if (features.length > 0) {
            var info = [];
            var i, ii;
            for (i = 0, ii = features.length; i < ii; ++i) {
                // info.push(features[i].get('name'));
            }
            //document.getElementById('info').innerHTML = info.join(', ') || '(unknown)';
            map.getTarget().style.cursor = 'pointer';
        } else {
            // document.getElementById('info').innerHTML = '&nbsp;';
            map.getTarget().style.cursor = '';
        }
    };



    $(map.getViewport()).on('mousemove', function(evt) {
        var pixel = map.getEventPixel(evt.originalEvent);
        displayFeatureInfo(pixel);
    });

    var modify = new ol.interaction.Modify({
        features: featureOverlay.getFeatures(),
        // the SHIFT key must be pressed to delete vertices, so
        // that new vertices can be drawn at the same position
        // of existing vertices
        deleteCondition: function(event) {
            return ol.events.condition.shiftKeyOnly(event) &&
                    ol.events.condition.singleClick(event);
        },
        style: new ol.style.Style({stroke : new ol.style.Stroke({
            color: '#FFFFFF',
            width: 10
        })
        })
    });
    map.addInteraction(modify);

</script>

</body>
</html>